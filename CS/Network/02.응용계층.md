# 02. 응용 계층

> 네트워크의 응용계층에 대해서 학습한다.

[🏠Home](https://github.com/batboy118/Study_Note)

[◀Previous page ](./)

---

<!-- TOC -->

- 

<!-- /TOC -->

## 1. 응용 계층의 예시

- 인터넷 브라우저 상의 응용
  - 구글 검색, 웹툰, 신문, 블로그, 카페, 금융, 쇼핑몰 등
- 이메일
- 게임
  - 스타크래프트, LOL 등
- 토렌트
- 파일 저장 서비스
- 스트리밍 서비스
- 지도 서비스
- SNS 서비스
- 예매 서비스

## 2. 네트워크 응용의 구조

- Client - Server 구조
  - 예 : 웹 검색
- Peer-to-Peer(P2P) 구조
  - 예 :  토렌트
- 하이브리드 구조
  - 클라이언트 - 서버 구조와 P2P 구조 동시 사용
  - 서버가 모든것을 개입하게 되면 부하가 심하기 때문에, 서버의 역할은 최소한으로 하고, 서버가 필요없는 기능은 P2P로 한다.
  - 예 : 스타크래프트, 스카이프(연결해주는 것은 서버로 해주지만 연결 후에는 P2P로 한다)

## 3. 프로세스간 통신

- 응용

  - 네트워크로 연결된 컴퓨터들이 협력하여 제공하는 서비스

    예) 구글 검색 (클라이언트는 서버에 서비스를 요청하고, 여러개의 서버 단말이 협력하여 서비스를 제공)

- 프로세스

  - 하나의 컴퓨터에서 독립된 메모리 공간을 가지고 수행되고 있는 프로그램의 단위

    예) 클라이언트 - 서버 : 클라이언트 프로세스 = 웹브라우저, 서버 프로세스 = 웹서버

    예) P2P : Peer 프로세스 = 토렌트

## 4.  프로세스 주소

어떻게 프로세스를 찾을 것인가?

- 기계 주소 : IP (32bit)
- 포트 번호 : TCP(16bit) / UDP(16bit)
  - 하나의 컴퓨터에서 제공하는 내부 주소
  - 주로 TCP 포트를 사용한다.
  - 웹서버 포트번호는 80으로 정해져 있다.
  - 웹 브라우저의 포트번호는 정해져 있지 않다.
  - 일반적으로 클라이언트에서 서버에 먼저 접속하기 때문에, 클라이언트가 패킷을 보낼때 클라이언트의 IP주소와 포트 번호를 둘다 보낸어 웹브라우저의 포트번호를 웹서버에서 알 수 있게 된다.

## 5. 소켓 통신

초기 통신 후 어떤 두 대상(클라이언트 - 서버 등)간의 통신을 Private Channel을 통해 할 수 있게 소켓을 이용할 수 있다.

소켓을 이용하면 서로 누군지 기억할 필요 없이 통신할 수 있다. 즉, 주소 없이 통신을 할 수 있다.

- 클라이언트 소켓 코드

```python
import socket

clientSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) #클라이언트 소켓 생성
clientSocket.connect(("203.253.146.138",9999)) #상대팡 IP와 포트번호

clinetSocket.send("Hello. Server.")
str = clinetSocket.recv(100) 
print str

ClientSocket.close()
```

- 서버 소켓 코드

```python
import socket

serverSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  #서버 소켓 생성
serverSocket.bind(("",9999))  #9999번 포트를 연다.
serverSocket.listen(1)  #클라이언트가 접속할 때까지 기다리겠다.

(sock, addr) = serverSocket.accept()  #클라이언트가 접속을하면, accept해준다.
									#이때 특정 대상과 통신을 위한 sock 소켓 객체를 생성한다.
sock.send("Hello. Client.")
str = sock.recv(100)   # 100바이트를 받음
print str

sock.close()
serverSocket.close()
```

> 서버 실행 후 클라이언트 실행 하면 서버에서 hello Server.를 출력함