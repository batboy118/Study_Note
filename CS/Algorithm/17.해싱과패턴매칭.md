# 17. 해싱과 패턴매칭

>특정 파일을 찾거나 특정 경로의 디렉토리를 따라가거나 여러 파일을 나열할 때 파일이 많다면 시스템 성능의 저하가 일어날 수 있다. 이러한 작업들은 검색 기반으로 수행되는 작업들이다. 이러한 작업을 효율적으로 하기 위해 해싱을 사용한다.

[🏠Home](https://github.com/batboy118/Study_Note)

[◀Previous page ](./README.md)

---

<!-- TOC -->

- [1. 해싱](#1-해싱)
	- [1.1. 직접 번지 테이블(배열)](#11-직접-번지-테이블배열)
	- [1.2. 해시 테이블](#12-해시-테이블)
- [2. 카프-라빈 알고리즘 (Karp-Rabin)](#2-카프-라빈-알고리즘-karp-rabin)

<!-- /TOC -->

## 1. 해싱

- 특정 항목 검색 시, 탐색 키에 대한 산술적 연산으로 키가 있는 위치를 계산하여 바로 찾아가는 방법
- 자료의 크기에 상관없이 O(1)의 시간안에 자료에 접근할 수 있다.
- 해시 함수
  - 탐색할 data를 해시값으로 변환하는 함수
- 해시 테이블
  - 해시 함수에 의해 반환된 주소의 위치에 항목을 저장한 자료구조
- 해시 검색 과정
  - 해시 함수에 탐색키를 입력하여 주소를 구하고 구한 주소에 해당하는 해시 테이블로 이동
  - 해당 주소에 원하는 항목이 있으면 검색 성광, 없으면 실패

### 1.1. 직접 번지 테이블(배열)

- 가장 간단한 방법은 직접 번지 테이블에 자료를 저장하는 방법으로, 전체 키의 집합(U)이 작은 경우에 효율적이다.
- 단점
  - 키의 집합(U)이 클 때, 테이블 생성 불가능
  - 메모리 공간 낭비 (실제 사용하지 않는 키의 공간도 할당됨)

### 1.2. 해시 테이블

- 전체 키의 집합(U)대비 실제 사용되는 키들의 집합(K)이 작을 때 사용
- 직접 번지 테이블보다 메모리 공간이 적게 필요
  - 저장 공간을 O(|K|)로 줄임
  - 키 값 k의 자료를 저장할 위치를 계산하는 해시 함수(h)를 사용
- 해시 함수 (h)
  - 해시 함수는 모든 키들의 집합(U)을 해시 테이블(T)에 대응 시킨다.
  - 테이블의 인덱스 범위를 줄여서 사용
  - h(k)는 키 값 k의 해시 값
  - 만약 두 키가 해시 테이블(T)에서 동일한 위치가 되는 상황을 충돌이라 한다.
- 충돌(Collision)
  - 서로 다른 키값을 해시 함수에 적용할 때, 반환된 해
  - 시 함수가 동일한 경우
  - **해시 함수가 해시 주소를 공평하게 분배해도 해시 테이블에 저장되는 키에 해당하는 자료의 수가 증가하면 충돌을 불가피 하다.**
  - 출돌을 해결하는 방법으로 **체이닝**과 **개방 주소 법**이 있다.

- 체이닝(Chaining)
  - 해시 테이블의 구조를 변경하여 각 버킷에 하나 이상의 키 값을 가지는 자료가 저장될 수  있도록 하는 방법

  - 하나의 버킷에 여러개의 키 값을 저장하도록 하기 위해 연결리스트를 활용함

    ![image](https://user-images.githubusercontent.com/53181778/79063715-41fe7300-7cde-11ea-82a9-e9d6e7ad123b.png)
- 개방 주소법(Open Address)
  - 해시함수로 구한 주소에 빈 공간이 없어 충돌이 발생하면 그 다음 위치에 빈 공간이 있는지 조사하는 방법
    - 빈 공간이 있을 경우 : 탐색키에 대한 항목 저장
    - 빈 공간이 없을 경우 : 공간이 나올 때 까지 탐색 반복

  ![image](https://user-images.githubusercontent.com/53181778/79063746-6f4b2100-7cde-11ea-9266-f00fb41d66ab.png)

## 2. 카프-라빈 알고리즘 (Karp-Rabin)

[패턴 매칭](09.패턴매칭_Pattern_Matching.md)(문자열 매칭)기법으로 이전에 KMP, 보이어 무어, 고지식한 알고리즘에 대해서 학습했었다. 이번에는 해싱을 이용한 문자열 매칭 알고리즘인 카프-라빈 알고리즘을 학습겠다.

- 문자열 검색을 위해 해시 함수를 이용하는 알고리즘

  - 패턴의 해시값과 텍스트내의 패턴의 길이 만큼의 문자열에 대한 해시 값 비교
  - 최악의 복잡도는 = O(NM)이지만, 평균적으로 선형에 가까운 빠른속도를 가진다.

- 카프-라빈 알고리즘의 아이디어

  - 텍스트 문자열 : `"6843212431"`
  - 찾으려는 패턴 : `"4321"`

  1. 패턴의 해시 값 계산
     - 패턴의 각 요소를 10진수로 생각하고 각 자리의 숫자에 자리값을 곱하고 모두 더해준다.
     - 정수값 : 4321

  2. 문자열을 패턴의 길이 만큼 쪼개서 해시값을 계산한다. 이떄 새로 추가되는 문자와 그 전에 계산한 값을 이용하여 최소한의 연산으로 해시값을 계산한다.

     - 예) 6843을 처음에 구한다. 하지만 다음 패턴을 검색할 때 6을 제외한 843이 그대로 사용되기 때문에 6843에서 843만을 취하여 10을 곱해주면 8430이 되고, 바로 다음 문자인 2를 더해주면 8432를 구할 수 있다.

     -  6843, 8432, 4321, 3212, 2124, 1243, 2431

- 고려사항

  - 패턴의 길이가 커지면 길이를 일정 자리수로 맞추기 위해 모듈러(%)연산을 취한다.
  - 해시 값이 일치할 경우 실제 문자열이 일치하는지 검사해야한다.
