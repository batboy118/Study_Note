# 01. NodeJS ë° Express ì›¹ì„œë²„ ì„¤ì •

>NodeJS ë° Express ì›¹ì„œë²„ ì„¤ì •

[ğŸ Home](https://github.com/batboy118/Study_Note)

[â—€Previous page ](./README.md)

---

<!-- TOC -->

- [1. í”„ë¡œì íŠ¸ ì‹œì‘í•˜ê¸°](#1-í”„ë¡œì íŠ¸-ì‹œì‘í•˜ê¸°)
- [2. Express ì›¹ ì„œë²„ ì„¤ì¹˜ ë° êµ¬ë™](#2-express-ì›¹-ì„œë²„-ì„¤ì¹˜-ë°-êµ¬ë™)
- [3. nodemon ì„¤ì¹˜](#3-nodemon-ì„¤ì¹˜)
- [4. URL Routing ì²˜ë¦¬](#4-url-routing-ì²˜ë¦¬)
- [5. Static ë””ë ‰í† ë¦¬ ì„¤ì •](#5-static-ë””ë ‰í† ë¦¬-ì„¤ì •)

<!-- /TOC -->

## 1. í”„ë¡œì íŠ¸ ì‹œì‘í•˜ê¸°

npm ì„¤ì¹˜ í›„ `npm init`ì„ í•˜ë©´ node.js í”„ë¡œì íŠ¸ë¥¼ ìƒì„± í•  ìˆ˜ ìˆë‹¤.

`npm init` ì„ í•˜ë©´  `package.json` ì´ ìƒì„±ë˜ê³ , package.json íŒŒì¼ì•ˆì— ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ê°ì²´ í˜•ì‹(í‚¤:ë°¸ë¥˜)ìœ¼ë¡œ í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹´ê³  ìˆëŠ” íŒŒì¼ì´ ìƒì„±ëœë‹¤.

```json
{
  "name": "node-practice",
  "version": "1.0.0",
  "description": "node server",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC"
}
```

## 2. Express ì›¹ ì„œë²„ ì„¤ì¹˜ ë° êµ¬ë™

Node ê¸°ë°˜ì˜ ì›¹ì„œë²„ê°€ ì—¬ëŸ¬ê°œ ìˆì§€ë§Œ ê·¸ì¤‘ ê°€ì¥ ëŒ€í‘œì ì¸ expressë¡œ ì‹¤ìŠµì„ ì§„í–‰í•œë‹¤.

`npm install express --save`ì„ ì´ìš©í•´ì„œ expressë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.

ì´ë•Œ, `--save`ì˜µì…˜ì€ ìë™ìœ¼ë¡œ ì„¤ì¹˜í•œ í”„ë¡œê·¸ë¨ì„  `package.json` ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤. ë‹¤ë¥¸ í™˜ê²½ì—ì„œ ë™ì¼í•œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ë•Œ ì˜ì¡´ì„± íŒŒì¼ì„ ë³´ê³  ê´€ë ¨ëœ íŒŒì¼ë“¤ì„ ì„¤ì¹˜í•´ì¤€ë‹¤.

`package.json`ì— ì•„ë˜ ë¶€ë¶„ì´ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤

```json
"dependencies": {
    "express": "^4.17.1"
  }
```

ë˜í•œ, `node_modules`ë¼ëŠ” ë””ë ‰í† ë¦¬ê°€ ìƒì„±ë˜ì—ˆë‹¤. express ëª¨ë“ˆì´ í•„ìš”ë¡œ í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬(ëª¨ë“ˆ)ê°€ `node_modules`ì•ˆì— ìƒì„±ì´ ëœ ê²ƒì´ë‹¤.

ì•„ë˜ jsíŒŒì¼ì„ ì‘ì„±í•´ë³´ì.

```javascript
//app.js
let express = require('express');
//node_modulesì— ìˆëŠ” expressì™€ ê´€ë ¨ëœ íŒŒì¼ì„ í•¨ìˆ˜í˜•íƒœë¡œ ê°€ì ¸ì˜´

let app = express();
//express í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ê²°ê³¼(ê°ì²´)ë¥¼ appì— ë‹´ëŠ”ë‹¤.
//let app = expressì´ ì•„ë‹Œ let app = express() ì„ì„ ëª…ì‹¬í•˜ì.
//ì¦‰, app != express

app.listen(3000, function() {
	console.log("start express server on port 3000");
})
```

ìƒì„±ëœ íŒŒì¼ì„ `node app.js` ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰í•´ë³´ë©´,  ì½˜ì†”ì— `start express server on port 3000`ì´ í”„ë¦°íŠ¸ ë˜ê³ , ëŒ€ê¸°ìƒíƒœë¡œ ìˆê²Œ ëœë‹¤. `listen`ì´ë¼ëŠ” í•¨ìˆ˜ê°€ 3000ë²ˆ í¬íŠ¸ë¥¼ í†µí•´ì„œ ì‘ë‹µì„ ë°›ê¸°ìœ„í•´ ëŒ€ê¸°ì¤‘ì¸ ìƒíƒœë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.

`http://localhost:3000/` ë˜ëŠ” `127.0.0.1:3000` ì— ì ‘ì†í•´ ë³´ë©´ ì ‘ì†ì€ ë˜ì§€ë§Œ `Cannot GET /` ì´ë¼ëŠ” ì—ëŸ¬ê°€ ë°œìƒë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ìˆë‹¤.

`ì»¨íŠ¸ë¡¤ + C`ë¡œ ì¢…ë£Œí•˜ê³  ì•„ë˜ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ëŒë ¤ë³´ë©´ ì´ìƒí•œ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```javascript
//app.js
let express = require('express');
let app = express();

app.listen(3000, function() {
	console.log("start express server on port 3000");
})

console.log('end of server code ...')
```

`end of server code ...`ê°€ ë¨¼ì € ì¶œë ¥ë˜ê³  `start express server on port 3000`ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì´ëŠ” í”„ë¡œê·¸ë¨ì´ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ë…¸ë“œì—ì„œ **ì½œë°±í•¨ìˆ˜**ëŠ” ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬ëœë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤. ìœ„ì—ì„œ ìˆœì°¨ì ìœ¼ë¡œ ì½”ë“œê°€ ì‹¤í–‰ë˜ì§€ë§Œ, ì„œë²„ê°€ ì‹¤í–‰ë ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³  ì•„ë˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì¦‰ì‹œ ì‹¤í–‰ëœë‹¤. ì¦‰, ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³ ë‚˜ì„œ ì½œë°±í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê¸°ê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì½œë°±í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•„ë„ ì•„ë˜ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê²Œ ëœë‹¤.

## 3. nodemon ì„¤ì¹˜

`nodemon`ì€ íŒŒì¼ì´ ë³€í•˜ë©´ ì„œë²„ë¥¼ ìë™ìœ¼ë¡œ ì¢…ë£Œí–ˆë‹¤ê°€ ë‹¤ì‹œ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” í”„ë¡œê·¸ë¨ì´ë‹¤.

`npm install nodemon --save -g`

`-g`ì˜µì…˜ì€ ê¸€ë¡œë²Œë¡œ ì„¤ì¹˜ í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ì¦‰, ë‚´ ì»´í“¨í„°ì—ì„œ ì–´ëŠ í”„ë¡œì íŠ¸(ë””ë ‰í† ë¦¬)ì—ì„œë“ ì§€ `nodemon`ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ì ìš©ì´ ëœë‹¤.

`nodemon app.js` ë¥¼ ì‹¤í–‰í•˜ë©´ íŒŒì¼ì˜ ë³€í™”ë¥¼ ê°ì§€í•´ì„œ ë‹¤ì‹œ ì¬ ì‹¤í–‰í•´ì¤€ë‹¤.

## 4. URL Routing ì²˜ë¦¬

```javascript
//app.js
const express = require('express');
const app = express()
const port = 3000

app.get('/',(req,res)=>{
	res.send("<h1>hi friend</h1>");
})

app.listen(port, function() {
	console.log("start express server on port 3000");
})
```

- ì•±ì€ ì„œë²„ë¥¼ ì‹œì‘í•˜ë©° 3000ë²ˆ í¬íŠ¸ì—ì„œ ì—°ê²°ì„ ì²­ì·¨í•©ë‹ˆë‹¤.
- URLì„ ìš”ì²­í•˜ê¸° ìœ„í•´ì„œ `get`ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•œë‹¤. ì¸ìë¡œ `request`ì™€ `response`ë¥¼ ë°›ëŠ”ë‹¤.
- `response`ê°ì²´ì— ìˆëŠ” `send`ë©”ì†Œë“œë¥¼ ì´ìš©í•´ì„œ íŠ¹ì • URI(URL) íŠ¹ì • í…ìŠ¤íŠ¸ë‚˜, HTMLì„ ì „ë‹¬í•´ ì¤„ ìˆ˜ ìˆë‹¤.
- ì•±ì€ ë£¨íŠ¸ URL(`/`) ë˜ëŠ” *ë¼ìš°íŠ¸*ì— ëŒ€í•œ ìš”ì²­ì— â€œ`<h1>hi friend</h1>`â€ë¡œ ì‘ë‹µí•˜ê³ , ë‹¤ë¥¸ ëª¨ë“  ê²½ë¡œì— ëŒ€í•´ì„œëŠ” **404 Not Found**ë¡œ ì‘ë‹µí•œë‹¤.

> `req`(ìš”ì²­) ë° `res`(ì‘ë‹µ)ëŠ” Nodeê°€ ì œê³µí•˜ëŠ” ë™ì¼í•œ ì˜¤ë¸Œì íŠ¸ì´ë©°, ë”°ë¼ì„œ `req.pipe()`, `req.on('data', callback)` ê·¸ë¦¬ê³  Expressì˜ ê´€ì—¬ê°€ í•„ìš” ì—†ëŠ” ë‹¤ë¥¸ ëª¨ë“  í•­ëª©ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì•„ë˜ì™€ ê°™ì´ `sendFile` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬  `public/main.html`ì„ ì‚¬ìš©í•œ ì‘ë‹µë„ í•  ìˆ˜ìˆë‹¤.

```html
<!-- public/html -->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>main.html</title>
</head>
<body>
	<h1>main page</h1>
	<p>Hello World!</p>
</body>
</html>
```

```javascript
//app.js
const express = require('express');
const app = express()
const port = 3000

app.listen(port, function() {
	console.log("start express server on port 3000");
})

app.get('/',(req,res)=>{
	res.sendFile(__dirname + '/public/main.html');
})
```

- í´ë¼ì´ì–¸íŠ¸ì—ì„œ í˜ì´ì§€ì— ì ‘ê·¼í•˜ë©´ `res.sendFile` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´  `__dirname + '/public/main.html'`ì— ì ‘ê·¼í•˜ì—¬ `main.html`ì„ ì‘ë‹µí•´ì¤€ë‹¤.

- ì›ë˜ëŠ” sendFileì„ í•  ë•Œì— ì „ì²´ ì ˆëŒ€ ê²½ë¡œë¥¼ ì ì–´ì•¼ í•˜ì§€ë§Œ, í˜„ì¬ ë””ë ‰í† ë¦¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê¸°ë³¸ ë³€ìˆ˜ì¸  `__dirname`ë¥¼ ì‚¬ìš©í•˜ì—¬ `__dirname + '/public/main.html'`ì™€ ê°™ì´ ê°„ë‹¨í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.

## 5. Static ë””ë ‰í† ë¦¬ ì„¤ì •

```html
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>main.html</title>
</head>
<body>
	<h1>main page</h1>
	<p>Hello World!</p>

	<script src="main.js"></script>
</body>
</html>
```

`<script src="main.js"></script>`ì„ ì¶”ê°€í•˜ê³ , ê°™ì€ ë””ë ‰í† ë¦¬ì— `main.js` íŒŒì¼ì„ ë§Œë“¤ê³  ë‹¤ì‹œ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œí‚¨ í›„ ê°œë°œì ëª¨ë“œì—ì„œ Networkë¥¼ ë³´ë©´ `main.js`ë¥¼ ì°¾ëŠ” ê³¼ì •ì—ì„œ `404`ì˜¤ë¥˜ê°€ ë‚˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

ì´ëŠ”, í´ë¼ì´ì–¸íŠ¸ì—ì„œ main.htmlì„ ë°›ì€ í›„ `<script src="main.js"></script>`ë¥¼ ë³´ê³  `main.js`íŒŒì¼ì„ ë‹¤ì‹œ ì„œë²„ì— ìš”ì²­ì„ í•˜ê²Œ ë˜ëŠ”ë° ì´ë•Œ, `main.js`ë¥¼ ì°¾ëŠ”ë° í•„ìš”í•œ ì²˜ë¦¬ë¥¼ ì•ˆí•´ì£¼ì–´ì„œ ê·¸ëŸ°ê²ƒì´ë‹¤.

ë³´í†µ, `.js`, `css`, `ì´ë¯¸ì§€` íŒŒì¼ ë“±ê³¼ ê°™ì€ íŒŒì¼ì„ ì •ì íŒŒì¼(Static íŒŒì¼)ì´ë¼ í•˜ëŠ”ë°, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ì—ê²Œ ì´ íŒŒì¼ë“¤ì„ ìš”ì²­í•˜ë©´ ì„œë²„ê°€ ì•Œì•„ì„œ ì „ë‹¬í•´ ì¤„ ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆë‹¤.

ê·¸ ë°©ë²•ì€ `static`íŒŒì¼ë“¤ì´ ìœ„ì¹˜í•œ ë””ë ‰í† ë¦¬ë¥¼ expressì—ê²Œ ì•Œë ¤ì£¼ëŠ” ê²ƒì´ë‹¤. `use(express.static("ë””ë ‰í† ë¦¬"))` ë©”ì†Œë“œë¥¼ ì“°ë©´ ëœë‹¤.

```javascript
//app.js
const express = require('express');
const app = express()
const port = 3000

app.listen(port, function() {
	console.log("start express server on port 3000");
})

app.get('/',(req,res)=>{
	res.sendFile(__dirname + '/public/main.html');
})

app.use(express.static("public"))
```

- `app.use(express.static("public"))`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ static íŒŒì¼ë“¤ì˜ ê²½ë¡œë¥¼ ì„¤ì •í•´ì¤„ ìˆ˜ ìˆë‹¤.

ì´ë¯¸ì§€ íŒŒì¼ì„ `public/img/pic.jpg`ì—ì„œ ë¶ˆëŸ¬ ì˜¤ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì.

```html
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>main.html</title>
</head>
<body>
	<h1>main page</h1>
	<p>Hello World!</p>
	<img src="img/pic.jpg" alt="">
	<script src="main.js"></script>
</body>
</html>
```

- ì´ë ‡ê²Œ ì‘ì„±í•˜ë©´ public ë‚´ì—ì„œ íŒŒì¼ì„ ì°¾ê¸° ë•Œë¬¸ì— ìë™ìœ¼ë¡œ, `public/img/pic.jpg`ìœ„ì¹˜ì—ì„œ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.

